//================================================
// This script checks that the 7-adic valuation of j-invariants of rational points of the modular curve Xns#(49) is always positive
//================================================


// Modular curves downloaded from the LMFDB on 11 June 2025.
// Magma code for modular curve with label 49.147.9.a.1

// Other names and/or labels
// Cummins-Pauli label: 49A9
// Rouse-Sutherland-Zureick-Brown label: 49.147.9.1

// Curve data
conductor := [[7, 36]];
bad_primes := [7];
// Genus
g := 9;
// Rank
r := 9;

// Modular data
// Number of cusps
Ncusps := 3;
// Number of rational cusps
Nrat_cusps := 0;
// CM discriminants
CM_discs := [-3];
// Groups containing given group, corresponding to curves covered by given curve
covers := ["7.21.0.a.1"];

// Models for this modular curve, if computed
Pol<x,y,z,w,t,u,v,r,s> := PolynomialRing(Rationals(), 9);
// Isomorphic to P^1?
is_P1 := false;

// Canonical model
model_0 := [x^2-y^2+y*z-y*w+z*w+x*t+t^2-x*u-z*u-t*u-u^2-y*v+u*v-2*y*r+z*r+t*r-u*r-x*s-y*s,x*y+y*z-z^2+x*w-y*w+z*w-w^2-y*t-x*u-t*u+u^2+x*v+y*v-u*v-z*r-x*s-y*s-w*s+t*s,x*y-y^2-y*z-z^2+x*w-y*w-w^2+z*t-x*u+y*u-w*u-t*u+u^2-w*v-t*v-x*r-t*r+u*r+z*s-w*s+t*s-u*s,y*z-y*w-z*w-x*t-y*t-z*t+w*t-x*u+u^2+y*v+z*v-t*v-x*r-t*r+u*r-z*s+t*s,x*y-y^2-y*z-z^2-2*y*w+2*z*w-w^2-x*t+y*t+z*t-w*t-x*u-y*u+x*v+y*v-z*v-w*v-x*r+z*s-t*s,x^2+x*y+y^2+x*z+y*z+z^2-x*w-y*w-x*t-y*t-z*t+t^2+2*x*u+y*u-u^2-x*v+y*v-t*v+u*v+v^2+x*r+z*r-u*r-x*s-y*s-v*s-r*s,x^2+3*x*z-y*z+z^2-3*z*w+y*t+w*t+y*u-z*u-w*u-t*u-y*v+z*v-w*v+x*r,y^2+x*z+y*z-z^2+2*z*w+w^2-x*t-y*t+z*t-x*u-y*u-z*u+2*t*u-x*v-t*v+u*v-2*x*r+z*r-t*r+u*r+2*w*s,2*y^2+2*x*z-y*z+z^2-x*w-z*w+w^2-x*t-2*y*t+t^2+y*u-z*u+w*u-t*v+w*r+2*w*s+t*s,y^2+2*x*z+2*y*z-w^2+x*t+x*u+y*u-2*t*u+u^2-x*v+t*v-u*v+v^2+x*r-w*r-u*r-2*x*s-y*s-z*s+u*s-v*s-r*s,2*x^2+x*y+2*y*z-x*w-y*w+z*w-y*t-z*t+t^2-z*u+w*u+t*u-u^2-x*v+y*v+w*v-t*v+u*v-x*r+w*r-x*s-2*y*s-2*w*s,x*y+y^2+2*x*z+y*z-z^2-y*w+z*w-w^2-x*t+y*t+x*u+y*u-w*u-t*u-x*v-y*v-w*v+2*t*v+u*v-v^2-2*w*r+t*r+r^2-x*s-y*s-r*s,x^2-x*y-y^2+2*x*w+w^2-y*t+t^2-w*u-t*u-x*v+y*v-2*t*v+u*v+v^2-y*r+z*r-u*r+w*s-v*s-r*s,2*y^2+x*z+z^2+z*w-w^2-2*y*t-w*t-t^2+y*u+2*w*u+t*v-u*v-z*r-w*r+w*s,x^2+2*x*y-x*z+2*y*z+z*w-x*t-y*t+x*u+t*u-u^2-x*v-y*v-z*v+w*v+t*v-y*r+t*r-u*r-x*s-y*s-w*s+t*s,2*x^2+x*y+2*x*z-x*w-y*w-z*w-w^2+2*y*u-z*u-w*u-t*u-y*v+z*v+w*v+u*v-v^2+u*r+r^2-x*s-y*s+z*s-w*s-u*s-r*s,x^2-x*y-y^2+x*z-y*z+z^2+x*w-w^2+x*t+y*t-z*t-y*u-z*u-t*u-u^2+x*v+z*v+w*v+x*r-y*r-z*r+w*r+t*r-u*r+x*s+z*s-w*s-2*t*s,x^2-x*y-y^2-2*x*z-z^2-y*w+x*t+y*t-t^2+w*u-x*v+y*v-x*r-z*r-w*r-y*s-w*s,x^2-x*y-2*y^2-y*w-2*z*w+w^2+2*y*t-z*t+2*w*t-x*u-y*u-2*w*u,x*y-y^2-x*z+2*y*z-z^2+y*w+z*w+w^2+x*t-y*t+t^2-x*u-w*u+u^2-2*y*v+w*v-u*v-x*r-y*r+w*r+u*r-x*s+z*s-w*s+t*s-u*s,x*y+x*z-y*z-z^2-2*y*w-z*w-3*x*t+x*u+z*u-w*u-t*u+u^2+2*y*v-z*v-t*v-z*r-v*r-x*s+y*s+t*s+2*v*s+r*s-s^2];



// j-invariant map from the canonical model

//   Coordinate number 0:
map_0_coord_0 := -2^3*7*(365784682240493788935728293321458333882503345702418666589284869757233912400*x*v*r^8+6344934464599749976029206004351192147840737630675165951127605531912235327104*x*v*r^7*s-11427224817816190634787473319017744729835977981249225197158969476838367635608*x*v*r^6*s^2+13455986515388481165577258967396478134387927441330445590879841548620396678838*x*v*r^5*s^3-6641202663423125281091032132279578203852662525142884371069911154748172963381*x*v*r^4*s^4+4934345584472969639403752752019297960489259266726541216159883742571598544639*x*v*r^3*s^5-2980699323152186161853109816471957276695770649330962502140522526989385489075*x*v*r^2*s^6-18524201745903487880517015460135751825493958655257652580230052823703137358920*x*v*r*s^7-15357196725065711560379258721202344392631804313566388566088011993227711009598*x*v*s^8-351090286809991350969858737628653132220048803849592520305709163194076584848*x*r^9+6917933754331996731012658886759204669495511107999281208407537283550983172256*x*r^8*s-16967492065824919597988397633172728712363049611412402096303406437997229817688*x*r^7*s^2+17007909441344220293110545771619479883042688549716461310743833058712437753030*x*r^6*s^3-5577061653654893820536804484343248723274658808228322206890782002396622185621*x*r^5*s^4-131607686449448641576846005164111919555340173263739307293987225579927160689*x*r^4*s^5-5386243395891101970173585735552245254938072818752882848113216638237270585363*x*r^3*s^6-5072240770414154797067513310238556551464464017378072288617501767652234895896*x*r^2*s^7-4427362179706694927217470630457478987833500364411278550235897479716695308350*x*r*s^8-1369176399152906152709696089455044630879435883420849851330491749390403776864*x*s^9-1395096365037526047667967197658893915154688635941997882335954099100166075648*y*v*r^8+3169911870803493654680127822481695946121195402092264922269547850512937927696*y*v*r^7*s-11931604303835068785886991918272646178029829474130855495008242233031680633944*y*v*r^6*s^2+3078698866877413819757748167266100039818894822470357615185719389765780963438*y*v*r^5*s^3-5259441778494328578741826881993691116152035513380482975827695148923360346260*y*v*r^4*s^4-9491675539102613137901582394464994671230316022097429399212979661023107539388*y*v*r^3*s^5-11125303720205009756580301822114485870168641681681553510568014281139196480962*y*v*r^2*s^6-4358522403152886308764947758558934913364809971633172719351342753947344551228*y*v*r*s^7-169086974300141597700639799961252736923012867054465783008341397843441876740*y*v*s^8-610400251113783115751747378296590129529871855503015755678458786175970846224*y*r^9+5064362084382001630087115552334010344229974519680461891703663634816054727072*y*r^8*s-12486604055937250690072371408171846126123938981217069744995838540862457295568*y*r^7*s^2+15295869238100458232507805374876402585473099980810981812089847567238813405124*y*r^6*s^3-9066904388955364275035174908842162206441427659243703001560983905268227466287*y*r^5*s^4+6851403320740108510054845397000381944429897278063341529865778760935835575894*y*r^4*s^5+159458382003635547561547658632008930796153556073511060340650999902635835002*y*r^3*s^6+5235842303299773168600382890996812867538519580357302687741997691935265901085*y*r^2*s^7+9218414326215272748978637961187506372681137422888854900908095537614586333630*y*r*s^8+6022204414687740991266760091893190406553102489611132309899942659393047075882*y*s^9+3657747775429142369807343530191311102582048920425332592274662299673489189008*z*v*r^8-11999255054265822773267250404132703502654586374277889170078655197173108917408*z*v*r^7*s+14600894286264845795548129194336526291230041779686819302367091857194006754648*z*v*r^6*s^2-1763025846464239610877128200434888367540464919878994101433864393947613755318*z*v*r^5*s^3+1029654487991758167965043275926493833367478482921490967989834112916943297291*z*v*r^4*s^4+2137056453507749475787132514738143280360167816620043831017625100306964658479*z*v*r^3*s^5+4498603432106358342819052301150954897677763273139772307227089058685410610169*z*v*r^2*s^6-5941725774080728015875435676810191550910461676147934218573687583575097007056*z*v*r*s^7-8713888625760823460794424560401056224514743782184809755487017505322232394726*z*v*s^8+1885311791352615136887462380114024654269160504371757938218379262722835619984*z*r^9-4638722189526334049845330171066372975159349908468453628222439070005844569232*z*r^8*s+7182216262247103236962394698284041200701617435633104289487244665537997660968*z*r^7*s^2+1220902473110072097736631009468112154605501688180960934109502796561890173750*z*r^6*s^3+3107891541512255073543356643076480975881994423157591004440673170685788429595*z*r^5*s^4+3458547730349429346994695968010273231495378191629866178217960596980891905910*z*r^4*s^5+4752584347343573347273517299920841800611941532265665356409949908871676507248*z*r^3*s^6+3989342022400031685547658104577062940742165065316259268611375713655850551719*z*r^2*s^7+2767424364735912831829142456858244532789178953358312637780737642681696177606*z*r*s^8+1867881575903238973202123218712264198162285245292648640291464783993838000678*z*s^9-1050750573066590272382311210606654601426514392198829309276640450331201739120*w*v*r^8+3529128581208846760487771936826109238937842743917883260417950564818880364464*w*v*r^7*s-7632671654470242749493818538674220171576999099202244850970727693087283680624*w*v*r^6*s^2-1323592916200473559475199006745041578830752795001654405827170543022368287792*w*v*r^5*s^3+251133918631945515575443842359291212973297309638859904595834378212252304363*w*v*r^4*s^4-3707427298364311445860175349791725892155503192689708781628762033284935735833*w*v*r^3*s^5-8220427371685670467073734778035036831453273847633382764818850961552417414125*w*v*r^2*s^6-6881314992919244546693626211924525073677551238248233174837670228678298926060*w*v*r*s^7-1975683057712557415831024654257851470278973671849062572780713570494931807378*w*v*s^8-334897278919115682650205947414160359147011989601957094558470495957570164672*w*r^9+2462844729255934190610596270607111369338654601540947477249433917654389305840*w*r^8*s-2761803920828149394769448130866691378340497980908390247725685250083742623992*w*r^7*s^2+3320230383571666837610342830784962611259877887295097308153700440018325093522*w*r^6*s^3+1248314780331474148154984895966445673840104532743306878254049703854592657224*w*r^5*s^4-3227747503376123347809506279984217900624575780746042079915007368760578271420*w*r^4*s^5+4063345025668467043376063778450003594032864286470803328993734855233173045754*w*r^3*s^6+571162433661362640811300907125255905695314225521348143294691372788284092000*w*r^2*s^7-10542273480826853129407013600235616754499972413995488717323700894572281949316*w*r*s^8-8757982168559878668498714497476766432704778503809632107667971687140480301752*w*s^9-1453103116308694833073072831797747396902135038488783599550186264279074048400*t*v*r^8+10032469235916812697771052800475392952323742552594157420044785084506126324832*t*v*r^7*s-9357900384054926444588647865281476983798776401546447296044108416133123211736*t*v*r^6*s^2+9600799560593936506772796268252087757842451407325358243963062607155836592478*t*v*r^5*s^3-1027176509039442855751959797488179990936420233418696543088528581242576627253*t*v*r^4*s^4+7811617236091395154969321036702661591535417374925459682468986432131256705951*t*v*r^3*s^5+8087072310804143301158523060540194754343821989136472115163345721520629835877*t*v*r^2*s^6+9942345001859593172163306687923146104122870097043464584707330805243833244520*t*v*r*s^7+6590547206104118187891379936391534849105438647844912727882633736474411145682*t*v*s^8-1579264782843713806095609718294116722517954733939574542263383424202965746112*t*r^9+2902048286282128485927918473832903612215380985662468659535251085610294603088*t*r^8*s-5955089901704816070938416186473161891014539120868031443007462694605682924720*t*r^7*s^2-2668944756137639037310322277607869148460843385826194996046019824898757524244*t*r^6*s^3-7534453260380162019001128800989918397397997101190474425358813506594321105114*t*r^5*s^4-3215364611428327486038534394077385807298805704406496381690808295576769154241*t*r^4*s^5-12748254189708732799494819793200482987728057783262107005982023960900477511185*t*r^3*s^6-10927187355576516470718979781437084306502725850164949664994245743274464924967*t*r^2*s^7+2685351840012806477372529819177524479915759036764897736816080460096923336576*t*r*s^8+5946206851154752173692452480026931247108581999677499102581255246638657780586*t*s^9+2001248472431165952433232609944244182460717077939514897733829450500664043808*u*v*r^8-7377004640640353544818266667209781319333928876564972517540678241633456092736*u*v*r^7*s+12121763355131866729766318780274706308571729195253540247286669311418592583024*u*v*r^6*s^2-10275029398866859518834650893331435629869058224650876871008468810123767943196*u*v*r^5*s^3+7826536071004663573048038704964215815391412856379833306308251308660886778282*u*v*r^4*s^4-1635980420965049739598798523138403690593358279887165799155689409434489899774*u*v*r^3*s^5+1662921151970809641412699779909668844414031907825296989712526911867713623766*u*v*r^2*s^6+101932195300116183047430237819855753172493702464952179174413001599562369968*u*v*r*s^7-1777228015704345469238098396240419639889361865541491115590497565536930899812*u*v*s^8+1501708660300463340529792425303956581656161824708540370849029150055823200352*u*r^9-5546862486884630119693049740195740607534323005252347958365702164043295586672*u*r^8*s+12521727950457405136995268178890612647098394559117725813249589570864009858928*u*r^7*s^2-7600981660153828166254854965396107969120634381543804978742679854975919528412*u*r^6*s^3+8218213237500546218890968694746436744773657012063356697990842046086226272654*u*r^5*s^4-227095148467207842767353985667616321593290443262178306900752243509517021489*u*r^4*s^5+10610217249914079983254510872866799894786308428547977092749411620486081046855*u*r^3*s^6+5797852188090306305304079910127969164995948664290612199817930406066846431217*u*r^2*s^7-3809378315457681326225215484300671755949781326359554084325984450346588195936*u*r*s^8-3787726054443981594936895503209343075338576156942787677131509948633656571366*u*s^9-327093058784629541664906938740662885164004721811823464480752921829060625600*v^3*r^7-878981812177338824467073143025986246595882728165151582570834499075995388048*v^3*r^6*s-663579968963710439075753079258658157088479659777217672409821462000580222888*v^3*r^5*s^2-257814304813697760758012570997276022180550421593171467323926976615884569830*v^3*r^4*s^3+638666636185155661407481822712875179116547334206125730107529802581370686066*v^3*r^3*s^4-169552314601149202322181463013835926424565820085189306241618543805384477262*v^3*r^2*s^5-837226541865865085969161664028051498445517583702496046137160771704255055160*v^3*r*s^6-174357110567338848814040357553249987140480642930674990064367856489849729740*v^3*s^7+78980644399099707904657158416678926316140538059112992036809918105736932240*v^2*r^8-24275595024198177522157313533654195503783151510392609752049199256589431840*v^2*r^7*s+1464970349891082095777586435154053196273824953422923701156529600376327842104*v^2*r^6*s^2-552498309856368791886978993417985464174448791660278753175181777550462077814*v^2*r^5*s^3+2119326029980701527392056263192352738745365568725164375660423509946304243623*v^2*r^4*s^4+2601441142889440638431684572849184970518923008520803512948667537080854884571*v^2*r^3*s^5+6435075106394049783642055475207322948437428099568550686645265456749990738741*v^2*r^2*s^6+13252584982594808276160792647917254494952655643236437319548233069520611394880*v^2*r*s^7+8636254518238092677811703548077176624262516797389400890515213713475764682610*v^2*s^8+83612078628743838140764253003220840898741209440067287198807651569825823088*v*r^9-38786384782334822959700382161335937443306715782956081837552296483954363216*v*r^8*s+2399044998533985300752411030392975510210371903553796690962490271803485130288*v*r^7*s^2+939518617669666379745545009194709357452363679198584517756479173065970912388*v*r^6*s^3-8968047064763498922303513085490829058703985958129426262604967739756998122985*v*r^5*s^4+16073944676706521318201400982003047797766566693862134398986589499855612667433*v*r^4*s^5+3729268994066127416612636139849364085229845393849461399266874757790322659209*v*r^3*s^6+8560224368678075518623313921073545921901351582820093895962200753596211842546*v*r^2*s^7+22114074544456298110730399290577734575686371784823503597955632608839181637574*v*r*s^8+15725361907725671591456521015661600364001311951287128471651829256068343935196*v*s^9-9654154477182799339802677523661802832499693843270068491705565617487598384*r^10-998179827195419211548888597602559983141719392224633158791939570182308151296*r^9*s+2134077833989609466004580570095468558754678553197952466139155731044524539320*r^8*s^2-769028095329077990816272486769214608910394134633853986373006130436655249566*r^7*s^3-6320493457885831688529679269127119757925251197248900761042425274171231086831*r^6*s^4+13122517386953234933216802014286772587583927957891608085309401603014161186791*r^5*s^5-6295481215893382769950373180904821587235102547071257955790397951122725136414*r^4*s^6+2170617587250235288227225346735149145553187300997637074767605039875993531311*r^3*s^7+18181476167295079666036446917126940403172121942896446978946817346642915919535*r^2*s^8+9617204098198132817212165536038754645583487437394603344054392407653934685376*r*s^9-6421818602733441916373583671579969931510600644444212275775585761907912351110*s^10);

//   Coordinate number 1:
map_0_coord_1 := 1*(39002442949813430997658242156764805051860607020447964732323395905002889888*x*v*r^8-100194071354183027885228496340474463189943272145197973054854428883410931488*x*v*r^7*s+51845552206639781021460722365429422851634270796914969940075776257661232612*x*v*r^6*s^2+61129165104772581866480241810671968658115346704833859281501679462434523892*x*v*r^5*s^3-61409634754058356366474231039268235385391905619685657396594822601071478783*x*v*r^4*s^4-9806017281480835788276478687019254231528919069779783592872536912009891215*x*v*r^3*s^5+32979663366325855465219105327319882078100928144378330341183874579602328301*x*v*r^2*s^6-9216337467091475531905671335947563526363752050774483711234656044470522836*x*v*r*s^7+988772933696645437417658547591430989557203566701665391853548378140820130*x*v*s^8+22377470109697869324173474184125836566335400025915396637503953065360290464*x*r^9-68791497339351728696165703163781552766927126773614371828281034207885139040*x*r^8*s+62587914280122248938518838957088145580055275625083909147509801956534191140*x*r^7*s^2+15263964928056633930825036348060800410596458212646668321311822968708496100*x*r^6*s^3-56916591003082596193787757461553525408094455010501179355313174621796877311*x*r^5*s^4+25599895086455036009855998656403815379172212239445063913456725861397801025*x*r^4*s^5+10473298162862247379291599146186930367805381544217114752323559832867807693*x*r^3*s^6-10765852571547853760575922509954691304792493845603640006244379628499496676*x*r^2*s^7+4565110317487967846195511891279343949469214132751564033680542418776263938*x*r*s^8-872051858911284142679241576519969791809513355860912738111703128412811744*x*s^9+29185986742112221245946873729769685120695423136678419652994577501511156000*y*v*r^8-75699987588562866887875126427643789071561147265387749475057404612997505920*y*v*r^7*s+63058349016182179991024641724997920376945983921156076101088182880241647828*y*v*r^6*s^2-231916368747988478574335004106747129934940269052718553916350499420259290*y*v*r^5*s^3-39681614069491854954648013543354441071985317038483588588484914670474645708*y*v*r^4*s^4+41723961208952840873815935407505755896027141307012754198526331828552454480*y*v*r^3*s^5-18944644369909755598826519056360824197178837802452068140970003595309217626*y*v*r^2*s^6+5283498892503149150091149206492034374618296395483456722687213102574991804*y*v*r*s^7-674379230148988863272268861129850588711465779968785805492927938972259940*y*v*s^8+24965029819326174133333891825164897398801910107394845354932192221631993920*y*r^9-96220309200363213863368633325992863839461730286959823073448871204789800960*y*r^8*s+132699861220948344552725365177980354673339189990304345805073599230592961256*y*r^7*s^2-63664343874495447794111605834447984047808048093097229258346390610196882274*y*r^6*s^3-23430640283530530564876559651537116391323070590994702387015895930093404355*y*r^5*s^4+37149876054228259586141096200998034969332255808484694609965050593051965162*y*r^4*s^5-12159897035113897715504404951973065750168926200338383518312436133234619684*y*r^3*s^6-2623766822678761563394848496852732114158613845541503709539056391714828647*y*r^2*s^7-287153907758570291438529492346032194840491767715931633673653589007045854*y*r*s^8+205600142125851577376162164532844452505339193035508547272929708707253738*y*s^9-26873353145865496590325883913549229671505092102427250445532594710304496928*z*v*r^8+73877321616013952416966599523358652423297154361780101000864180179698793120*z*v*r^7*s-69519196346238060110284121898459278597167281766448886889304437064085555876*z*v*r^6*s^2+29971359525415769307874157651367198866108505764413805293661511056347435080*z*v*r^5*s^3-8622763345390635338740703648973124367873593939456826545475503335205587807*z*v*r^4*s^4-6497526262047991584074685182288121839686213324860718267469462164450575975*z*v*r^3*s^5+10617001204351840683815676501672697003877762984672138384322657522261607881*z*v*r^2*s^6-1054169074349897780409500313013344497561418574597561390657481949872502252*z*v*r*s^7-357611734661244459512242126020192354012532014983848785494503807966953222*z*v*s^8-22171853185173403438942459326890618276842010994033373793968818053929994976*z*r^9+58430631702576012975209212716416211555288835795784575610118499618433741312*z*r^8*s-48495154797314538887253095131525840897631261292278447727406624798187981580*z*r^7*s^2+11307835378070976300596274675508876928601245929054524543013814474839230452*z*r^6*s^3+2473440958010727032280865988004347946632380478567439815708685005401513767*z*r^5*s^4-10473770159360774559811195724502384518223777296396870302546209051902662170*z*r^4*s^5+16910255184521301862567629785592757498416799576125693667286910311864183286*z*r^3*s^6-13111798406424359584175148524658995417347791625501142187672318509416751981*z*r^2*s^7+3960588606454357302706678516514605208199495124594193710612081348058914274*z*r*s^8-565487636819784898053422924913915660165907806877700949232320449051738490*z*s^9+10186831112957778852002584075544238848449571965378494836308384793377446912*w*v*r^8-19201384702806609595017692198404532668576380779594286387307042773455876800*w*v*r^7*s-3135198862969599907606221504557283766329140198465229131512822117060548176*w*v*r^6*s^2+32932974261009804282461137550081401096514286286773058848314136968357731726*w*v*r^5*s^3-35285218774601159693588301563203668591758274276470408228962076321364369391*w*v*r^4*s^4+16206322711500201757590246256745067348025230582178532662475517474410485813*w*v*r^3*s^5+827931885702073173950447119034448746626253302146480829088308292420660939*w*v*r^2*s^6-1590543100106703683495288914337943171825833985458628178952413251913713760*w*v*r*s^7+459886313363557356498706392645525422791361124276478440302470668502546158*w*v*s^8+3487629442799919960071878250874792852084398303201265715228342008896944224*w*r^9-11898659199785115020682325369835620188190097266158017233798118247149715168*w*r^8*s+12675074171566636897101228832072142813696300944439391763915144861726039260*w*r^7*s^2-9361651911085018712339892671861963378582052114826400297347492365818861790*w*r^6*s^3+10795834363714774505572927526787060959950824059792819263365471903591894864*w*r^5*s^4+5914353662672992502748099306774190544385163120043791274662326571447681512*w*r^4*s^5-31222218964225953803996474482528118991571049772490908550990157084379815046*w*r^3*s^6+28136438776132249801902354133647324812632575721855411822258186794018609048*w*r^2*s^7-7430538412672401997201141052907192384723129483046509766815615167406809748*w*r*s^8+882197612222404445651993358709294076496421589864676978346163518776536328*w*s^9+31184137017553064431691449579404270095705036984294732617285111588423260960*t*v*r^8-82305088690464640185185463063886657086137819337961944678734171940141208992*t*v*r^7*s+58642488850365110706934549430720863045866999804208731939014167986119017236*t*v*r^6*s^2-5744394094150175042194490048391103024548745023768401980521409839877330692*t*v*r^5*s^3+9462555439079376272590467351180585369558161344941083359320170436971517249*t*v*r^4*s^4-17617632882940849804529321084836785475011253206551499429042901079233026687*t*v*r^3*s^5+3288343242265226685433932157280982812251362262618778407067853766634506437*t*v*r^2*s^6-3138220250449590190204898632827672491439013775277243771143262230968473924*t*v*r*s^7+1038521920689940994789993009974076565666487748752683041465977062804964242*t*v*s^8+20469657378084336962558472701846675125809193811515728637704159295965942720*t*r^9-45828029840250069407934295705856094203737883156979747239304416663826725472*t*r^8*s+22993212745322829619170962072984975900649647703904329269613430603266573432*t*r^7*s^2+24834471994633806849121042252913300551409834320665938871981165885048620136*t*r^6*s^3-43029872303741737428638538644507174190263003344360880560693703148657883380*t*r^5*s^4+22723431935042557677428611153230549429183766842144015652579964266827912597*t*r^4*s^5+11319755386626370034347524630074443461470698158518388689639303770588330713*t*r^3*s^6-14742601344763347020091145505684689831205662042442644291243456959676365975*t*r^2*s^7+3678991437108465570121931239470420217475511597925824993291763004514732804*t*r*s^8-284302384764423714121792616188753013177862903070637158867255529584212438*t*s^9-38064499547763122366530987719752509125475759375349809496040066677438632896*u*v*r^8+104157488259408008882228001544689996806651547918159394128549648963796175232*u*v*r^7*s-87092673673500667211639896360511311852975390854145363962674179472042010216*u*v*r^6*s^2+15890771563726080958216808569104151978830759414865192535133984086091903720*u*v*r^5*s^3+2659257654018440427744048936304894530617440090087071887459860726718660478*u*v*r^4*s^4+3614288950914522790646237762194365964179179086213198193828478269681443326*u*v*r^3*s^5-1302103528875225935711450813174810577330117927154510517564595376629058986*u*v*r^2*s^6+1106257999723172345295299889965567729534938663433067404554264865319291720*u*v*r*s^7-482350084037658797508486151126676545214376864019534483364681458254739812*u*v*s^8-20201459259271403583275454975610156011196711731924945273501780384194114496*u*r^9+62744820773223635189427923977081239745570804140972738274822692195058537248*u*r^8*s-70282617180401533767654432817436254865181414454509813420501420869841628984*u*r^7*s^2+19252570309484891589416332688510086367630958050028865468195706213088852400*u*r^6*s^3+22926891877881375836806551482400768098625520248286623067369191269790237556*u*r^5*s^4-10566695558189865223492592456223111352780740794933069964985459278912023851*u*r^4*s^5-18928387550331510638389851954670401264270309050033228075602059956685114047*u*r^3*s^6+17568688442046992688983821193809123561520260002224443423891247458740565217*u*r^2*s^7-4995658237500681523844728113564466950720060604337429617813487895050065948*u*r*s^8+647294451787974623019949430874458084618419412493617216131880722439667066*u*s^9-534063939686497463617651638064494517394489371239817837386120924472971552*v^3*r^7-539600771541933231849439417319451669944704306479524259444686894747950080*v^3*r^6*s+1865543688232659970523013049994693680020406742277389990375493574594911708*v^3*r^5*s^2-2979280720732001347729967265547254362043133001149528120943183139598128114*v^3*r^4*s^3+2151282727631018970297264751926252173307545724771932265423938232032292294*v^3*r^3*s^4-2294965595127838067030713310397157918882352048489284660066663449812251902*v^3*r^2*s^5+981263618510266495611598938784664427498482359468006739915073671172759504*v^3*r*s^6-3112033768098985470602733934406584994779203919209149282885986235328684*v^3*s^7+258294947987719301930876187876657422736899568591641831018126416237145184*v^2*r^8-6611820556743540595939158023005993759945946499122177679642048757481622752*v^2*r^7*s+16681854026881029763014978902200538644666509821720718464424543337332529148*v^2*r^6*s^2-22014049975730080893632813826912343708157499591906514312155336899113716064*v^2*r^5*s^3+8536495204366683571663059700485405966988937168920290171516727320818082229*v^2*r^4*s^4+13054157956162413569284459853885139458532247182261680919119803478828686877*v^2*r^3*s^5-21593246823766387405307282303038474813336827027428188897304198993025364379*v^2*r^2*s^6+5904578321798352173739251173842467231036907148081191936811306284923043412*v^2*r*s^7-418793449026984278591187853669642076726648984751222254835483286001478510*v^2*s^8+12946442588114423975806569273537695282780882768615443574799237612169650240*v*r^9-64958168214345703918411632947537340831057816524549293083883720245969363680*v*r^8*s+111954105817793047328593091181817859174868988013795137507766237778305885240*v*r^7*s^2-75516994661961299199439173309374800418693363672733044041593329286277503814*v*r^6*s^3-7510520998102746533632712597629047221944029237234341016887079577078947119*v*r^5*s^4+31422759127122390524524536360784345641413156939644718694762765577316888339*v*r^4*s^5-7297830767878477392587816868038034864537106526391311967478486887371205587*v*r^3*s^6-11708137073826247182233782837883250878945203922642141582024747973538033682*v*r^2*s^7+326359670107232969190092089023107003960725822485861386449345636949372862*v*r*s^8+464557010296903273704099783647088849411321249318290443940872184398612284*v*s^9+6746309976507826574771008847854459763043072341578271506972829756290272096*r^10-36767271906529998214669519190675361905435810293137107025955463845007920512*r^9*s+71998331420602142418837828516051027454174881449519733394284525492755618332*r^8*s^2-53913363402856354190519118769301060780024614334595920897122483967561393556*r^7*s^3-13722214690430630945503970090689154631451709632488122019727600655632167881*r^6*s^4+37513547953103144920502238064480721687767879034168902626556229541129046779*r^5*s^5+1422405008057988875041759828500223794322351087337398599211423843558562280*r^4*s^6-27958402777795544473914121950353118962686990447731016296390452244820255755*r^3*s^7+11703340311882008849136105775453186312922854390931772388699402578056223359*r^2*s^8-746851483628793875431170924329357822754798105820881881476562540903025788*r*s^9-123693799360073311552883233768536487278322779836836809425453333255394630*s^10);


//----------------------------------------------------


// We now verify that v_7(j(E)) > 0 when E is a point on X_ns^#(49)


// ======================================================================
// RationalPointsOverRing
//
// INPUT:
// - X : projective variety defined over Z (or at least coercible to Z/p^nZ)
// - p : a prime number
// - n : a positive integer
//
// OUTPUT:
// - A list of points on X with coordinates in Z/p^nZ, given as sequences
//
// DESCRIPTION:
// - Computes the Z/p^nZ-rational points of the variety X recursively.
// - For n = 1, returns usual F_p-points.
// - For n > 1, lifts each point mod p^{n-1} to all possible lifts mod p^n,
//   by solving polynomial congruences modulo p in the tangent space.
//
// METHOD:
// - Use Hensel lifting: each mod p^{n-1} point gives rise to solutions
//   modulo p^n that reduce to it mod p^{n-1}.
// - For each such point, set up variables x_i for lifts and solve
//   F(x_1,...,x_d) = 0 mod p^n using expansion around base point.
//
// ======================================================================
function RationalPointsOverRing(X, p, n)
    if n eq 1 then
        // Base case: F_p-rational points
        return [ Eltseq(P) : P in RationalPoints(ChangeRing(X, GF(p))) ];
    else
        R := Integers(p^n);
        d := Dimension(AmbientSpace(X)) + 1;

        // Clear denominators from equations defining X
        PolysOverZ := ClearDenominators(DefiningPolynomials(X));
        PolRingModpn<[x]> := PolynomialRing(R, d);
        Polys := [ PolRingModpn!pol : pol in PolysOverZ ];

        Points := [];

        // Recursive step: lift points from mod p^{n-1}
        for P in RationalPointsOverRing(X, p, n - 1) do

            // Lift equations: evaluate polynomials at lifted variables
            LiftedPolys := [
                Evaluate(pol, [R!Integers()!P[i] + p^(n - 1)*x[i] : i in [1..d]])
                : pol in Polys
            ];

            // Reduce lifted equations modulo p to get linear system over F_p
            DividedPolys := [
                PolynomialRing(GF(p), d) |
                ChangeRing(
                    ChangeRing(ChangeRing(pol, Integers()), Rationals()) / p^(n - 1),
                    GF(p)
                )
                : pol in LiftedPolys
            ];

            // Solve linear system over F_p to find valid lifts
            KerForP := Variety(ideal<PolynomialRing(GF(p), d) | DividedPolys>);

            // Construct actual lifts to Z/p^n Z using solutions to linear system
            lifting := func<seq |
                [
                    [R!Integers()!seq[i] + p^(n - 1)*R!Integers()!y[i] : i in [1..d]]
                    : y in KerForP
                ]
            >;

            Points cat:= lifting(P);
        end for;

        return Points;
    end if;
end function;

X:=Curve(ProjectiveSpace(Pol), model_0);
jNum:=map_0_coord_0;
jDen:=map_0_coord_1;


// We check that the for each Z/49Z-point of Xns#(49) the j-invariant is 0 modulo 7

Points49:=RationalPointsOverRing(X, 7, 2);

check:=true;

for P in Points49 do
    vNum:=Evaluate(jNum, P);
    vDen:=Evaluate(jDen, P);
    if not ((vNum eq 0) and (vDen ne 0)) then
        check:=false;
	print P, vNum, vDen;
    end if;
end for;

if check then
    "j(P) is 0 mod 49 for every point P in X(Z/49Z)";
else
    "There is a point P in X(Z/49Z) for which j(P) is not 0";
end if;
